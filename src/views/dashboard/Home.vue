<template>
  <div class="dashboard__inner">
    <div class="dashboard__head">
      <h1>Hello, {{ fullName }}!</h1>
    </div>
    <div class="stats-cards">
      <div class="stats-cards__cont stats-cards__cont--double">
        <div class="stats-card">
          <div class="stats-card__upper">
            <h3 class="stats-card__title">Total earnings</h3>
            <div class="stats-card__filter">
              <div class="ds_select">
                <select name="version">
                  <option value="" default selected>ALL TIME</option>
                  <option value="">LAST 3 MONTHS</option>
                  <option value="">LAST 6 MONTHS</option>
                  <option value="">LAST YEAR</option>
                </select>
              </div>
            </div>
          </div>
          <div class="stats-card__value">â‚¬0</div>
        </div>
        <div class="stats-card">
          <div class="stats-card__upper">
            <h3 class="stats-card__title">Total assets</h3>
            <div class="stats-card__filter">
              <div class="ds_select">
                <select name="version">
                  <option value="" default selected>ALL TIME</option>
                  <option value="">LAST 3 MONTHS</option>
                  <option value="">LAST 6 MONTHS</option>
                  <option value="">LAST YEAR</option>
                </select>
              </div>
            </div>
          </div>
          <div class="stats-card__value">13</div>
        </div>
      </div>
      <div class="stats-cards__cont">
        <div class="stats-card">
          <div class="stats-card__upper">
            <h3 class="stats-card__title">Sales</h3>
            <a href="#">VIEW ALL <img src="@/assets/images/icons/right_arrow.svg" alt=""></a>
          </div>
          <div class="stats-card__chart">
            <bar-chart></bar-chart>
          </div>
        </div>
      </div>
      <div class="stats-cards__cont">
        <div class="stats-card">
          <div class="stats-card__upper">
            <h3 class="stats-card__title">Trust status</h3>
            <div class="stats-card__filter">
              <div class="ds_select">
                <select name="version">
                  <option value="" default selected>ALL TIME</option>
                  <option value="">LAST 3 MONTHS</option>
                  <option value="">LAST 6 MONTHS</option>
                  <option value="">LAST YEAR</option>
                </select>
              </div>
            </div>
          </div>
          <div class="stats-card__chart">
            <line-chart></line-chart>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script lang="ts">
import { Component, Vue } from 'vue-property-decorator';
import BarChart from '@/components/Charts/BarChart.vue';
import LineChart from '@/components/Charts/LineChart.vue';
import ProviderAssetsApi from '@/service/provider-assets';
import store from '@/store';
import { EnumProviderAssetSortField, ProviderDraftQuery } from '@/model/provider-assets';
import { EnumAssetType } from '@/model/enum';

@Component({
  components: {
    BarChart,
    LineChart,
  },
})
export default class DashboardHome extends Vue {
  fullName: string;

  providerAssetsApi: ProviderAssetsApi;

  itemsNum;

  constructor() {
    super();

    this.providerAssetsApi = new ProviderAssetsApi();

    this.fullName = '';
  }

  created(): void {
    const profile = store.getters.getProfile;
    this.fullName = `${profile.firstName} ${profile.lastName}`;

    this.setNumberOfItems();
  }

  setNumberOfItems(): void {
    store.commit('setLoading', true);

    // todo: currently, providerAssetsApi does not work correctly (ignores parameters). Also, I can not ask api for multiple types.
    const query: ProviderDraftQuery = {
      q: '',
      type: EnumAssetType.VECTOR,
      pageRequest: {
        page: 0,
        size: 100000,
      },
      sorting: {
        id: EnumProviderAssetSortField.TITLE,
        order: 'ASC',
      },
    };

    this.providerAssetsApi.find(query).then((response) => {
      this.itemsNum = response.result.count;
      store.commit('setLoading', false);
    });
  }
}
</script>
<style lang="scss">
  @import "@/assets/styles/_stats.scss";
  @import "@/assets/styles/_select.scss";
</style>
